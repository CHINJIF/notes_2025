COMP5121
Data Mining and Data Warehousing Applications

Week 4: Data Warehousing, OLAP, and Data Cube Technology

Dr. Fengmei Jin
ï‚§ Email: fengmei.jin@polyu.edu.hk
ï‚§ Office: PQ747 (+852 3400 3327)
ï‚§ Consultation Hours: 2:30-4:30pm every Thursday

Outline

ï¯ Basic Concepts
ï¯ Data Warehouse Modeling: Data Cube and OLAP
ï¯ Data Warehouse Design and Usage
ï¯ Efficient Data Cube Computation Methods

2

What is a Data Warehouse?

ï¯ Commonly defined as a:

ï® Subject-oriented system that is organized for major entities 

such as customers, products, sales

ï® Integrated platform that consolidates data from different 

sources 

ï® Time-variant approach that keeps historical snapshots of data 

over time.

ï® Non-volatile environment: data is stable once loaded, primarily 

read-only.

â€œA data warehouse is a subject-oriented, integrated, time-variant, 
and nonvolatile collection of data in support of managementâ€™s 
decision-making process.â€ â€“ W. H. Inmon

3

Data â€œWarehousingâ€

ï¯ The process of constructing and leveraging data warehouses 

for decision support
ï® Maintains a specialized decision-support database separate from 

operational systems

ï® Supports information processing via a solid platform for historical 

data analysis

4

Data Warehouse â€“ Subject-Oriented

ï¯ Organized around major subjects

ï® e.g., customer, supplier, product, and sales

ï¯ Focusing on modeling and analyzing data for decision makers 

ï® instead of daily operations or transaction processing

ï¯ Provide a simple and concise view of particular subject issues 

ï® by excluding data that are not useful in decision-making

5

Data Warehouse â€“ Integrated

ï¯ Constructed by integrating heterogeneous data sources

ï® e.g., relational DBs, flat files, on-line transaction records, â€¦

ï¯ Data Cleaning and Data Integration techniques are applied.
ï® To ensure consistency in naming conventions, encoding 

structures, attribute measures, and so on.

ï® For example, hotel price may differ in currency, tax, breakfast 

inclusion, and parking fees.

ï¯ When data is moved to the warehouse, it is converted!

6

Data Warehouse â€“ Time-Variant

ï¯ The time horizon for the data warehouse is much longer than 

that of operational systems
ï® Operational DB: current value data
ï® Data warehouse: from a historical view (e.g., past 5-10 years)

ï¯ Every key structure in the data warehouse includes a time 

element, either explicitly or implicitly.
ï® For example, sales data might be aggregated by month, even if each 

individual record doesnâ€™t have a specific date attached. 

ï® But the key in operational DBs may or may not contain such â€œtime 

elementâ€ â€“ e.g., a customer table.

7

Data Warehouse â€“ Non-volatile

ï¯ Independence: A physically separate store of data

ï® Transformed and independent from the application data found in 

the operational environment

ï¯ Static: Operational updates do not occur in data warehouses
ï® No transaction processing, recovery, and concurrency controls
ï® Only two required operations in data accessing: initial loading of 

data and access to data

8

OLTP vs. OLAP

OLTP in operational DB

OLAP in data warehouse

Full Name

On-Line Transactional Processing

On-Line Analytical Processing

Functions 

customer-oriented:
daily operations, transaction and 
query processing 

market-oriented:
complex query, data analysis, decision 
support

Users

clerks, clients, DBA, IT professionals

Contents

current, up-to-date data â€“ too detailed
to be easily used for decision making

knowledge worker: managers, executives, 
analysts, etc.

large amounts of historical data â€“
summarized, integrated, information at 
different granularities

DB Design

application-oriented: entity-
relationship (ER) data model

subject-oriented: a star or a snowflake 
model

View

within an enterprise or department

Access

Size

data in: read/write, index/hash on 
prime key

tens records; GB to high-order GB; 
thousands users

multiple versions of a DB schema; data 
from different organizations

information out: lots of read-only scans

millions records; 

TB; hundreds users

9

â‰¥

Why a Separate Data Warehouse?

ï¯ High performance for both systems:

â€¢ DBMS â€“ tuned for OLTP: access methods, indexing, hashing, concurrency control, recovery

â€¢ Warehouse â€“ tuned for OLAP: complex OLAP queries, consolidation, multi-dimensional view

ï¯ Different data and functions:

ï® Data warehouses are structured for analysis, with standardized 
schemas and consolidated information from diverse sources.
ï® Data warehouses support complex analytics on historical data. 

Operational databases handle frequent transactions and updates. 
ï¯ Some systems perform OLAP directly on DBs, but performance 

and scalability may be limited.

10

Data Warehouse: A Multi-Tiered Architecture

ïƒ  Top tier: front-end tools provide 

query, reporting, analysis, and data 
mining tools (e.g., trend analysis, 
predictions)

ïƒ  Feed data into bottom tier 

after preprocessing

11

Three Types of Data Warehouse Models

ï¯ Enterprise Warehouse (full-size)

ï® Collect all information about subjects spanning the entire organization
ï¯ corporate-wide data integration, cross-functional in scope, both detailed and  
summarized data, size ranging from a few gigabytes to terabytes, or beyond. 

ï¯ extensive business modeling and take years to design / build using high-

performance platforms like supercomputers

ï¯ Data Mart (partial)

ï® A subset of corporate-wide summarized data â€“ tailored to meet the 

needs of a specific group of users
ï¯ low-cost departmental servers, simpler implementation cycle 

ï¯ Virtual Warehouse (minimal)

ï® A set of views over operational databases â€“ only some of the possible 

summary views may be materialized. 

12

Extraction, Transformation, and Loading (ETL)

ï¯ Extraction: gather data from multiple/external sources
ï¯ Cleaning: detect errors and rectify them when possible
ï¯ Transformation: convert data from legacy or host format to 

warehouse format

ï¯ Load: sort, summarize, consolidate, compute views, check 

integrity, and build indices and partitions

ï¯ Refresh: propagate the updates from the data sources to the 

warehouse

13

Metadata Repository

ï¯ Metadata is the data defining warehouse objects. It stores:

ï® Description of the data warehouse structure: schema, views, dimensions, 
hierarchies, derived data definition, data mart locations and contents
ï® Operational metadata: data lineage, currency of data (active, archived, or 

purged), monitoring information (usage, statistics, error reports)

ï® Algorithms used for summarization
ï® The mapping from operational environment to the data warehouse
ï® Data related to system performance: indices and profiles for data access 
and retrieval performance, rules for the timing and scheduling of refresh, 
update, and replication cycles

ï® Business data: business terms/definitions, data ownership, charging 

policies

14

multidimensional data model, data cube, online analytical processing

DATA WAREHOUSE MODELING: DATA CUBE AND OLAP

15

From Tables and Spreadsheets to Data Cubes

ï¯ A data warehouse is based on a multi-dimensional data mode,  

which views data in the form of a data cube, defined by:
ï® Dimension tables: to describe a dimension, e.g., item (item_name, 

brand, type), or time (day, week, month, quarter, year) 

ï® Fact table: to store numeric measures (e.g., dollars_sold) and keys 

linking to dimension tables â€“ analyze relationships between dimensions 

ï¯ Data cube is typically 

-dimensional.

ï® The 
ï® The topmost 
ğ‘›ğ‘›

ğ‘›ğ‘›

-dimensional base cube is called a base cuboid.

-dimensional cuboid, which provides the highest-level 

summarization, is called the apex cuboid.
ï® All levels of cuboids form the entire data cube.

0

16

Example: Structure of Data Cube

17

Example: a 3-D Data Cube

18

Schemas for Multi-dimensional Data Models

ï¯ Entity-Relationship (ER) model and the schema

ï® a set of entities and their relationships â€“ appropriate for OLTP

Stu_Id

Stu_name

Cou_Id

Cou_name

Student

study

Course

ï¯ A multi-dimensional model for data warehouses: focus on 

dimensions and measures, in the form of:
ï® star schema, snowflake schema, fact constellation schema

19

(1) Star Schema

A fact table in the center, surrounded 
by a set of dimension tables 

time

time_key
day
day_of_the_week
month
quarter
year

branch

branch_key
branch_name
branch_type

Measures

Sales (Fact Table)

time_key

item_key

branch_key

location_key

units_sold

dollars_sold

avg_sales

item

item_key
item_name
brand
type
supplier_type

location

location_key
street
city
state_or_province
country

20

(2) Snowflake Schema

A variant of star schema: some dimensional 
hierarchy is normalized ïƒ  thereby splitting the 
data into additional smaller dimension tables

time

time_key
day
day_of_the_week
month
quarter
year

branch

branch_key
branch_name
branch_type

Measures

Sales (Fact Table)

time_key

item_key

branch_key

location_key

units_sold

dollars_sold

avg_sales

item

item_key
item_name
brand
type
supplier_key

location

location_key
street
city_key

supplier

supplier_key
supplier_type

city

city_key
city
state_or_province
country

21

(3) Fact Constellation

allow dimension tables to be shared between 
multiple fact tables ïƒ  a collection of stars

time

time_key
day
day_of_the_week
month
quarter
year

branch

branch_key
branch_name
branch_type

Measures

Sales (Fact Table)

time_key

item_key

branch_key

location_key

units_sold

dollars_sold

avg_sales

Shipping (Fact Table)

item

item_key
item_name
brand
type
supplier_type

location

location_key
street
city
state_or_province
country

time_key

item_key

shipper_key

from_location

to_location

dollars_cost

units_shipped

shipper

shipper_key
shipper_name
location_key
shipper_type

22

The Role of Concept Hierarchies

all

all

region

Europe

...

North_America

country

Germany

...

Spain

Canada

...

Mexico

city

Frankfurt

...

Vancouver

...

Toronto

A lattice for time

office

L. Chan

...

M. Wind

A hierarchy for location

23

View of Warehouses and Hierarchies

Specification of hierarchies
1) Schema hierarchy: 

â€¢ day < month < quarter; 
â€¢ day < week < year

2) Set_grouping hierarchy

inexpensive

1 â€¦ 10 <

24

Data Cube Measures

ï¯ How are measures computed?

ï® Distributive: if the result derived by applying the function to 

aggregate 

values is the same as that derived by applying the function on all the 
data without partitioning

ğ‘›ğ‘›

e.g., 

, 

, 

, 

ï® Algebraic: if it can be computed by an algebraic function with 

ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘›ğ‘›ğ‘ğ‘()

ğ‘ ğ‘ ğ‘ğ‘ğ‘ ğ‘ ()

ğ‘ ğ‘ ğ‘šğ‘šğ‘›ğ‘›()

ğ‘ ğ‘ ğ‘šğ‘šğ‘šğ‘š()

arguments (where 
applying a distributive aggregate function
ğ‘€ğ‘€

e.g., 

is a bounded integer), each of which is obtained by 

ğ‘€ğ‘€

ğ‘šğ‘šğ‘ğ‘ğ‘ğ‘ ğ‘šğ‘š = ğ‘ ğ‘ ğ‘ğ‘ğ‘ ğ‘  ğ‘šğ‘š /ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘›ğ‘›ğ‘ğ‘ ğ‘šğ‘š
ï® Holistic: if there does not exist an algebraic function that characterizes 
, 

the computation

e.g., 

, 

ğ‘ ğ‘ ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘šğ‘šğ‘šğ‘›ğ‘›()

ğ‘ ğ‘ ğ‘ğ‘ğ‘šğ‘šğ‘šğ‘š()

ğ‘Ÿğ‘Ÿğ‘šğ‘šğ‘›ğ‘›ğ‘Ÿğ‘Ÿ()

25

A Sample Data Cube

TV

PC

VCR

sum

Quarter

1Qtr

2Qtr

3Qtr

4Qtr

sum

Total annual sales 
of TVs in U.S.A.

U.S.A

Canada

Mexico

y
r
t
n
u
o
C

sum

Sales volume as a function of 
product, quarter, and country

Industry   Region         Year

Category   Country Quarter

Product

City     Month    Week

Office         Day

26

Typical OLAP Operations

ï¯ Roll up (drill-up): summarize data by climbing up hierarchy or by 

dimension reduction techniques

ï¯ Drill down (roll-down): reverse of roll-up

ï® from higher-level summary to lower-level summary or detailed data, or 

introducing new dimensions

ï¯ Slice and dice: project and select 
ï¯ Pivot (rotate): reorient the cube, visualization, 3D to series of 2D planes
ï¯ Other operations:

ï® Drill-across: involving (across) more than one fact table
ï® Drill-through: through the bottom level of the cube to its back-end 

relational tables (using SQL)

27

Typical OLAP Operations

ï¯ Roll up (drill-up)

ï® summarize data by 

climbing up hierarchy for 
a dimension or by 
dimension reduction

ï¯ Dice

ï® define a subcube by 

performing a selection
on two or more 
dimensions

Typical OLAP Operations

ï¯ Roll-down (drill-down): 

reverse of roll-up
ï® from higher-level 

summary to lower-level 
summary or detailed 
data, or introducing new 
dimensions

ï¯ Slice: define a subcube by 
performing a selection on 
one dimension

ï¯ Pivot (rotate): reorient the 
cube, visualization, 3D to 
series of 2D planes

A Star-Net Query Model

Shipping Method

Customer Orders

Customer

AIR-EXPRESS

CONTRACTS

TRUCK

ORDER

These represent the 
granularities available for 
use by OLAP operations. 

Time

YEAR

QUARTER

WEEK

NAME

BRAND

TYPE

Product

CITY

COUNTRY

REGION

Location

SALESPERSON

DISTRICT

DIVISION

Promotion

Organization

32

Browsing a Data Cube

ï¯ Visualization
ï¯ OLAP capabilities
ï¯ Interactive manipulation

33

business analysis, information processing, data mining, â€¦

DATA WAREHOUSE DESIGN AND USAGE

34

A Business Analysis Framework for Data Warehouse Design

ï¯ Four views regarding the design of data warehouse

ï® Top-down View â€“ focus on selecting relevant information to align 

the data warehouse with current / future business needs

ï® Data Source View â€“ expose the information being captured, 

stored, and managed by operational systems

ï® Data Warehouse View â€“ represent the fact / dimension tables

ï® Business Query View â€“ see the perspectives of data in the 

warehouse from the end-userâ€™s viewpoint

35

Data Warehouse Design Process 

ï¯ Top-down, bottom-up approaches or a combination of both

ï® Top-down: starts with overall design and planning (mature)
ï® Bottom-up: starts with experiments and prototypes (rapid)

ï¯ Typical Design Process

ï® Choose a business process to model, e.g., orders, invoices, shipments, etc.
ï® Choose the business process grain (atomic level of data, e.g., transaction)
ï® Choose the dimensions that will apply to each fact table record (time, item, â€¦)
ï® Choose the measure that will populate each fact table record (dollars_sold)

36

Data Warehouse Usage

ï¯ Three kinds of data warehouse applications:

ï® Information Processing: supports querying, basic statistical 

analysis, and reporting using crosstabs, tables, charts
ï¯ low-cost web-based accessing tools integrated with web browsers

ï® Analytical Processing: multi-dimensional data analysis

ï¯ basic OLAP operations, slice-dice, drilling, pivoting

ï® Data Mining: knowledge discovery

ï¯ hidden patterns and associations, analytical models, classification and 

prediction, presenting the mining results using visualization

37

From OLAP to On-Line Analytical Mining (OLAM)

ï¯ Why online analytical mining?

ï® High-quality data in data warehouses â€“ integrated, consistent, 

cleaned data

ï® Available information processing infrastructure surrounding data 

warehouses
ï¯ accessing, integration, consolidation, and transformation of multiple DBs, 

Web accessing and service facilities, and reporting and OLAP tools

ï® OLAP-based exploration of multi-dimensional data

ï¯ Mining with drilling, dicing, slicing, pivoting, etc.
ï® On-line selection of data mining functions

ï¯ Integration and swapping of multiple mining functions, algorithms, tasks

38

compute cube op, iceberg cube, bitmap, join index, ... 

EFFICIENT DATA CUBE COMPUTATION

39

Efficient Data Cube Computation

ï¯ Data cube can be viewed as a lattice of cuboids  

ï® The bottom-most cuboid is the base cuboid â€“ the most specific
ï® The top-most cuboid (apex) contains only one cell â€“ the most 

generalized (all)

â€¢ Drilling down: start from apex cuboid and explore downward
â€¢ Rolling up: start at the base cuboid and explore upward

â€¢ 0-D op: i.e., no group-by SQL, like â€œcompute 

the sum of total salesâ€

â€¢ 1-D op: one group-by, e.g., â€œcompute the sum 

of sales, group-by cityâ€

â€¢ â€¦
â€¢ The cube operator is the 

-dimensional 

generalization of the group-by operator.

ğ‘›ğ‘›

40

â€œCompute Cubeâ€ Operator

ï¯ Cube definition and computation in DMQL (Data Mining Query 

Language)

â€¢ define cube sales [city, item, year]: sum (sales_in_dollars)
â€¢ compute cube sales

ï¯ Practical Implementation: Transform it into a SQL-like language 
(with a new operator cube-by, introduced by Gray et al.â€™96)

SELECT city, item, year, SUM (amount)
FROM SALES
CUBE BY city, item, year

41

Cube Materialization: Full Cube vs. Iceberg Cube

ï¯ Only a small portion of the cubeâ€™s cells may have meaningful 

data (i.e., "above the water" in a sparse cube).
ï® Full Cube: to compute all possible combinations of dimensions 

and measures in a data cube.

ï® Iceberg Cube: to compute only the cells that meet a specified 
iceberg condition, such as a minimum threshold for a measure.

compute cube sales_iceberg as
select month, city, customer_group, count(*)
from salesInfo
cube by month, city, customer_group
having count(*) >= min_support

iceberg condition: Filters out low-value cells, 
retaining only significant data.

42

Efficient Processing of OLAP Queries

ï¯ Steps to Efficiently Process an OLAP Query

ï® Identify the dimensions and filters

ï¯ e.g., on {brand, province} with â€œyear = 2004â€

ï® Convert OLAP operations into SQL-like operations:

ï¯ e.g., dice = selection (year = 2004) + projection (brand, province)

ï® Select the best materialized cuboids

ï¯ Compare the query with available cuboids
ï¯ Use cost-based estimation to choose the most efficient one

43

Efficient Processing of OLAP Queries

ï¯ Query on {brand, province} with â€œyear = 2004â€

ï® Require dimensions of â€œbrandâ€ and â€œprovinceâ€, and a filter on â€œyearâ€
ï® 4 materialized cuboids are available. 
ï¯ Cuboid 1: {year, item_name, city}  
ï¯ Cuboid 2: {year, brand, country}
ï¯ Cuboid 3: {year, brand, province}
ï¯ Cuboid 4: {item_name, province} where year = 2004

Hierarchy
â€¢
â€¢ city < province < country

item_name < brand < type

ï® Which should be selected to process the query efficiently?

â€¢ Not C2: Finer-granularity data CANNOT be generated from coarser-granularity data. 
â€¢ Not C1: Cost the most as both item name and city are at a lower level
â€¢ C3 or C4? Cost-based estimation helps determine which is better.

44

Indexing OLAP Data: Bitmap Index

ï¯ Index on a particular column â€“ bit-op is fast

ï®

bits are needed for the attributes with 

values.

ï¯ If a record on the attribute has a value 
ğ‘›ğ‘›
ï¯ All other bits for that row are set to 0.

representing 

in the base table, then the bit 
ğ‘›ğ‘›
is set to 1 in the corresponding row of the bitmap index. 

ğ‘ğ‘

ï® NOT suitable for high-cardinality domains

ğ‘ğ‘

Base table

Index on Region

Index on Type

Cust Region Type
Retail
Asia
C1
Europe Dealer
C2
Dealer
Asia
C3
America Retail
C4
Europe Dealer
C5

RecIDAsia Europe America

1
2
3
4
5

1
0
1
0
0

0
1
0
0
1

0
0
0
1
0

RecID Retail Dealer
1
0
0
1
0

0
1
1
0
1

1
2
3
4
5

45

Indexing OLAP Data: Join Index

ï¯ To register the joinable rows of relations 

from a relational DB
ï® Maintain the joinable relationship 
ï® Speed up cross-table search in star schema
ï¯ the fact tableâ€™s foreign key & the dimension 

tableâ€™s primary key

ï¯ e.g., linking the sales fact table with two 

dimensions, location and item
ï® Join index could span dimensions.
ï® Identify sub-cubes that are of interest

46

Summary

ï¯ Data warehouse: subject-oriented, integrated, time-variant, and 

nonvolatile data collection organized for decision making
ï® Distinguish and be maintained separately from operational databases
ï® Architecture: data sources â€“ bottom tier (RDBMS server) â€“ middle tier 
(OLAP server) â€“ top tier (client, end-user for query / reporting tools)
ï® Multidimensional data model: star/snowflake/fact constellation schema
ï® Data cube: fact (measures), dimensions; a lattice of cuboids (each with 
a different degree of summarization); concept hierarchies; indexing
ï® OLAP operations: roll-up, drill-down, slice, dice, and pivot (rotate); 

bitmap index and join index for efficiency

ï® Applications: information processing, analytical processing, data mining

47

Email: fengmei.jin@polyu.edu.hk

Office: PQ747

THANK YOU!

48

